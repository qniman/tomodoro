# üîß –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è install.sh v3.0

## –ü—Ä–æ–±–ª–µ–º—ã, –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ `./install.sh` –Ω–∞ Linux (Debian) –≤—ã—è–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏:

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 1: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç PHP —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è xml –∏ dom
**–í—ã–≤–æ–¥ –æ—à–∏–±–∫–∏:**
```
Problem 1
  - Root composer.json requires laravel/pint ^1.24 -> satisfiable by laravel/pint[v1.24.0, ..., v1.27.0].
  - laravel/pint[v1.24.0, ..., v1.27.0] require ext-xml * -> it is missing
  
Problem 2
  - phpunit/phpunit[11.5.0, ..., 11.5.50] require ext-dom * -> it is missing
```

**–ü—Ä–∏—á–∏–Ω–∞**: `apt-get install php8.2-xml` –ù–ï —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è. –ù–∞ Debian —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ PHP 8.3, –Ω–æ —Å–∫—Ä–∏–ø—Ç –ø—ã—Ç–∞–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å 8.2.

**–†–µ—à–µ–Ω–∏–µ** –≤ v3.0:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –≤–µ—Ä—Å–∏—é PHP: `php -v | grep -oP 'PHP \K[0-9]+\.[0-9]+'`
- ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏: `php8.3-xml`, `php8.3-dom`
- ‚úÖ –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ PHP –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π: `php -m | grep xml`
- ‚úÖ –ï—Å–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç, –¥–æ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏—Ö –ø–µ—Ä–µ–¥ composer install

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 2: –û—à–∏–±–∫–∞ composer —Å–∫—Ä—ã—Ç–∞ –ø–æ–¥ —É—Å–ø–µ—Ö–æ–º
**–ü–æ–≤–µ–¥–µ–Ω–∏–µ**: –°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∑–∞–ª `[‚úì] PHP –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã` —Ö–æ—Ç—è composer —É–ø–∞–ª

**–ü—Ä–∏—á–∏–Ω–∞**: `2>&1 | tee` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç exit code. –ö–æ–≥–¥–∞ –µ—Å—Ç—å pipe, `$?` —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è exit –∫–æ–¥–æ–º –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–æ–º–∞–Ω–¥—ã (tee), –∞ –Ω–µ –ø–µ—Ä–≤–æ–π (composer).

**–†–µ—à–µ–Ω–∏–µ** –≤ v3.0:
```bash
# –î–û (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
composer install 2>&1 | tee /tmp/composer.log || { error }

# –ü–û–°–õ–ï (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
composer install 2>&1 | tee /tmp/composer.log
COMPOSER_EXIT=${PIPESTATUS[0]}  # –ë–µ—Ä–µ–º exit –∫–æ–¥ composer, –Ω–µ tee
if [ $COMPOSER_EXIT -ne 0 ]; then
    print_error "–û—à–∏–±–∫–∞"
fi
```

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 3: Node.js –≤–µ—Ä—Å–∏—è 18 –≤–º–µ—Å—Ç–æ 20
**–í—ã–≤–æ–¥ –æ—à–∏–±–∫–∏:**
```
npm WARN EBADENGINE Unsupported engine {
npm WARN EBADENGINE   package: 'vite@7.3.1',
npm WARN EBADENGINE   required: { node: '^20.19.0 || >=22.12.0' },
npm WARN EBADENGINE   current: { node: 'v18.19.1', npm: '9.2.0' }
}
```

**–ü—Ä–∏—á–∏–Ω–∞**: –ù–∞ —Å–∏—Å—Ç–µ–º–µ –º–æ–≥–ª–∞ –±—ã—Ç—å —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è Node.js, —Å–∫—Ä–∏–ø—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ, –∞ –Ω–µ –≤–µ—Ä—Å–∏—é.

**–†–µ—à–µ–Ω–∏–µ** –≤ v3.0:
```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–µ—Ä—Å–∏—é Node.js
NODE_MAJOR=$(node -v | cut -d'v' -f2 | cut -d'.' -f1)
if [ "$NODE_MAJOR" -lt 20 ]; then
    print_warning "Node.js –≤–µ—Ä—Å–∏—è < 20. –û–±–Ω–æ–≤–ª—è–µ–º..."
    curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
    sudo apt-get install -y nodejs
fi
```

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 4: vendor/autoload.php –Ω–µ –Ω–∞–π–¥–µ–Ω
**–í—ã–≤–æ–¥ –æ—à–∏–±–∫–∏:**
```
PHP Warning: require(/home/qsi/tomodoro/vendor/autoload.php): Failed to open stream
PHP Fatal error: Uncaught Error: Failed opening required '/home/qsi/tomodoro/vendor/autoload.php'
```

**–ü—Ä–∏—á–∏–Ω–∞**: Composer install —É–ø–∞–ª (–ø—Ä–æ–±–ª–µ–º–∞ 1), –Ω–æ —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–¥–æ–ª–∂–∏–ª –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –ø–æ–ø—ã—Ç–∞–ª—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å `php artisan` –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ composer (–ø—Ä–æ–±–ª–µ–º–∞ 2) - —Ç–µ–ø–µ—Ä—å —Å–∫—Ä–∏–ø—Ç –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–µ.

---

## ‚úÖ –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ v3.0

### 1. –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ PHP
```bash
PHP_VERSION=$(php -v | grep -oP 'PHP \K[0-9]+\.[0-9]+' | head -1)
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
sudo apt-get install -y php${PHP_VERSION}-xml php${PHP_VERSION}-dom
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π –ø–µ—Ä–µ–¥ composer
```bash
for ext in xml dom curl mbstring zip; do
    if ! php -m | grep -qi "^$ext$"; then
        sudo apt-get install -y php${PHP_VERSION}-${ext}
    fi
done
```

### 3. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ exit –∫–æ–¥–æ–≤
```bash
composer install 2>&1 | tee /tmp/composer.log
COMPOSER_EXIT=${PIPESTATUS[0]}
if [ $COMPOSER_EXIT -ne 0 ]; then
    print_error "–û—à–∏–±–∫–∞"
fi
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ Node.js
```bash
NODE_MAJOR=$(node -v | cut -d'v' -f2 | cut -d'.' -f1)
if [ "$NODE_MAJOR" -lt 20 ]; then
    curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
    sudo apt-get install -y nodejs
fi
```

### 5. –õ—É—á—à–µ –æ–±—Ä–∞–±–æ—Ç–∫–∞ npm –∏ npm run build
- –ò—Å–ø–æ–ª—å–∑—É–µ–º `${PIPESTATUS}` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ exit –∫–æ–¥–∞
- –í—ã–≤–æ–¥–∏–º –ø–æ–ª–Ω—ã–µ –ª–æ–≥–∏ –æ—à–∏–±–æ–∫
- –ü—Ä–µ—Ä—ã–≤–∞–µ–º —Å–∫—Ä–∏–ø—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ

---

## üìä –î–æ –∏ –ü–æ—Å–ª–µ

| –ü—Ä–æ–±–ª–µ–º–∞ | –î–æ | –ü–æ—Å–ª–µ |
|---------|----|----|
| PHP —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è | ‚ùå –ù–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è | ‚úÖ –ü—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è |
| –í–µ—Ä—Å–∏—è PHP | ‚ùå –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ 8.2 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è (8.3+) |
| –û—à–∏–±–∫–∞ composer | ‚ùå –°–∫—Ä—ã—Ç–∞ –ø–æ–¥ [‚úì] | ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∏ –ø–æ–∫–∞–∑–∞–Ω–∞ |
| Exit –∫–æ–¥ —Å pipe | ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π | ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π ${PIPESTATUS} |
| –í–µ—Ä—Å–∏—è Node.js | ‚ùå –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è | ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –¥–æ 20+ |
| vendor/autoload.php | ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ | ‚úÖ –ù–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç |

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
chmod +x install.sh
./install.sh
```

–°–∫—Ä–∏–ø—Ç —Ç–µ–ø–µ—Ä—å:
1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é PHP
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç –≤—Å–µ —Ç—Ä–µ–±—É–µ–º—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –∏—Ö
3. –û–±–Ω–æ–≤–∏—Ç Node.js –µ—Å–ª–∏ –≤–µ—Ä—Å–∏—è < 20
4. –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –æ—à–∏–±–∫–∏ composer/npm
5. –ü—Ä–µ—Ä–≤–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ –≤–º–µ—Å—Ç–æ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è

---

**–í–µ—Ä—Å–∏—è**: 3.0  
**–î–∞—Ç–∞**: 2024  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
